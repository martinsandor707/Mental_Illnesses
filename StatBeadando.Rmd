---
title: "Mental illnesses"
author: "Martin Sándor (F145XS)"
date: "2024-11-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Mentális betegségek elemzése
Az adatokat az [internetről szedtem le](https://www.kaggle.com/code/imtkaggleteam/mental-health-eda-prediction), fogalmam sincs, hogy valósak-e. Az oszlopokat átneveztem a könnyebb hivatkozás érdekében

## Az adatok megismerése

```{r}
illnesses <- read.csv('mental_illnesses.csv')
head(illnesses)
```


```{r}
usa_illnesses <- illnesses[illnesses["Code"] == "USA",]

#All disorders are represented as a % of the population
library(ggplot2)
ggplot(usa_illnesses, aes(x=Year, y=Depressive_disorders)) + geom_line(color="red4") + theme_minimal() + labs(title= "% of depressed population in the USA over time") + theme(plot.title = element_text(hjust=0.5, size=20, face="bold"))
```

Országonként nagy eltérések lehetnek az adatokban
```{r}
ggplot(illnesses[illnesses["Code"] == "CHN",], aes(x=Year, y=Depressive_disorders)) + geom_line(color="red4") + theme_minimal() + labs(title= "% of depressed population in China over time") + theme(plot.title = element_text(hjust=0.5, size=20, face="bold"))
```


```{r}
usa_disorders <- illnesses[c("Schizophrenia", "Depressive_disorders", "Anxiety_disorders", "Bipolar_disorders", "Eating_disorders")]
head(usa_disorders)

```

```{r}
cor(usa_disorders)
```
A korreálciós mátrix alapján közepesen erős negatív korreálció van a skizofrénia és a depresszió között, míg a bipoláris zavar pozitív korrelációban áll a szorongással és az étkezési zavarokkal.

```{r}

pcaUSA <- princomp(usa_disorders, cor = T)
summary(pcaUSA, loadings = T)
```
```{r}
screeplot(pcaUSA, col = 'blue', pch = 16, type = 'lines', cex = 2, lwd = 2, main = " ")
```

A módosított Kaiser szabály szerint csak a >=0.7 varianciájú komponenseket tartjuk meg, ebben az esetben az első kettőt. 

```{r}
eigen_values <- eigen(cor(usa_disorders))$values
scree_data <- data.frame(
  Factors = 1:length(eigen_values),
  Eigenvalues = eigen_values
)

ggplot(scree_data, aes(x = Factors, y = Eigenvalues)) +
  geom_point() +
  geom_line() +
  labs(title = "Scree Plot", x = "Factors", y = "Eigenvalues") +
  theme_minimal() +
  scale_x_continuous(breaks = 1:length(eigen_values)) +
  theme(axis.text.x = element_text(size = 12), 
        axis.text.y = element_text(size = 12), 
        title = element_text(size = 14))
```

Akkora faktorszámmal dolgozunk, amennyi sajátérték 1 fölött van az adathalmazon, ebben az esetben 2-vel

```{r}
fit <- factanal(usa_disorders, factors = 2, rotation="varimax")
print(fit)
```
Az eredmény nem túl meggyőző, a chi négyzet statisztika túl magas, és faktorszámban sem mehetünk feljebb. Emellett p értéke 0-közeli, így elutasítjuk a nullhipotézist, ami az lett volna, hogy a faktorok tökéletesen magyarázzák a paramétereket. Ezt az is megerősíti, hogy a két faktor kumulatív varianciája 0.66, tehát a kommunalitás csupán a variancia 2/3 részét magyarázza.

```{r}


```
